import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import java.util.List;

public class SwitchToIframeColumnFunction {

    public static void main(String[] args) {
        // Initialize the WebDriver
        WebDriver driver = new ChromeDriver();

        // Open the webpage
        driver.get("https://www.sec.gov/ix?doc=/Archives/edgar/data/821189/000082118924000021/eog-20240331.htm");

        try {
            // Wait until the iframe with id "ixvFrame" is present
            WebDriverWait wait = new WebDriverWait(driver, 10);
            wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("ixvFrame"));

            // Call the function to retrieve the value from the third column for "Total Assets"
            String thirdColumnValue = getColumnValue(driver, "Total Assets", 3);

            // Print the retrieved value
            System.out.println("Third Column Value: " + thirdColumnValue);

        } catch (Exception e) {
            System.out.println("Error occurred while switching to iframe or retrieving elements.");
            e.printStackTrace();
        } finally {
            // Close the WebDriver
            driver.quit();
        }
    }

    // Function to retrieve the value of a specified column for a row identified by searchText in the first column
    public static String getColumnValue(WebDriver driver, String searchText, int columnIndex) {
        String columnValue = "";

        try {
            // Find all matching elements with the XPath
            List<WebElement> allElements = driver.findElements(By.xpath("//tr//td[1][span[contains(text(),'" + searchText + "')]]"));

            // Check if any matching elements were found
            if (!allElements.isEmpty()) {
                // Get the first matching element
                WebElement firstElement = allElements.get(0);

                // Adjust the columnIndex by subtracting 1 for 0-based indexing within the function
                int adjustedColumnIndex = columnIndex - 1;

                // Now find the value of the specified adjusted column for this element
                WebElement columnElement = firstElement.findElement(By.xpath("./following-sibling::td[" + adjustedColumnIndex + "]"));

                // Get the text of the column
                columnValue = columnElement.getText().trim();
            } else {
                System.out.println("No matching elements found for: " + searchText);
            }

        } catch (Exception e) {
            System.out.println("Error occurred while retrieving column value for: " + searchText);
            e.printStackTrace();
        }

        return columnValue;
    }
}
